#define  nMA 44
#define  nE0 8

double KfactorAxialsApproximate(double MAtest, double E0test)
{
  double KKffactor[nMA][nE0];

  // mass of A' in GeV
  double  MMAA[nMA] = {0.001, 0.002, 0.004, 0.006, 0.008, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0};

  // Beam energy of electrons in GeV
  double EE00[nE0] = {20, 40, 60, 80, 100, 120, 140, 160};

  // -----Beam energy------     20    |    40   |   60    |   80    |   100   |   120   |   140   |   160
  double KfMA1MeV[nE0] =    {0.431694, 0.430975, 0.430717, 0.430584, 0.430501, 0.430445, 0.430398, 0.430440};
  double KfMA2MeV[nE0] =    {0.735010, 0.732298, 0.731334, 0.730836, 0.730522, 0.730310, 0.730157, 0.729728};
  double KfMA4MeV[nE0] =    {0.927905, 0.919091, 0.915941, 0.914301, 0.913285, 0.912592, 0.912089, 0.911705};
  double KfMA6MeV[nE0] =    {1.017300, 1.000210, 0.994041, 0.990819, 0.988823, 0.987456, 0.986460, 0.985700};
  double KfMA8MeV[nE0] =    {1.081970, 1.054930, 1.045060, 1.039870, 1.036650, 1.034450, 1.032840, 1.031610};
  double KfMA10MeV[nE0] =   {1.137390, 1.099210, 1.085080, 1.077610, 1.072970, 1.069760, 1.067420, 1.06563};
  double KfMA20MeV[nE0] =   {1.369170, 1.273070, 1.233020, 1.211090, 1.197090, 1.187320, 1.180090, 1.17453};
  double KfMA30MeV[nE0] =   {1.545790, 1.415590, 1.352740, 1.315580, 1.290970, 1.273410, 1.260210, 1.24993};
  double KfMA40MeV[nE0] =   {1.673170, 1.529450, 1.454020, 1.405820, 1.372260, 1.347510, 1.328490, 1.31344};
  double KfMA50MeV[nE0] =   {1.772050, 1.615890, 1.535100, 1.481310, 1.442170, 1.412240, 1.388600, 1.36950};
  double KfMA60MeV[nE0] =   {1.855410, 1.683450, 1.598510, 1.542150, 1.500330, 1.467510, 1.441030, 1.41903};
  double KfMA70MeV[nE0] =   {1.929440, 1.739640, 1.649530, 1.591110, 1.547920, 1.513720, 1.485630, 1.46212};
  double KfMA80MeV[nE0] =   {1.997450, 1.789040, 1.692750, 1.631760, 1.587330, 1.552310, 1.523460, 1.49916};
  double KfMA90MeV[nE0] =   {2.061390, 1.834230, 1.731150, 1.667040, 1.621060, 1.585170, 1.555750, 1.53103};
  double KfMA100MeV[nE0] =  {2.122520, 1.876700, 1.766530, 1.698900, 1.651020, 1.614030, 1.583960, 1.55884};
  double KfMA200MeV[nE0] =  {2.065370, 1.996100, 1.975270, 1.960980, 1.888070, 1.833650, 1.790910, 1.75688};
  double KfMA300MeV[nE0] =  {2.116760, 1.995050, 1.947740, 1.924280, 1.911060, 1.902390, 1.897500, 1.89327};
  double KfMA400MeV[nE0] =  {2.207510, 2.038870, 1.967050, 1.928440, 1.904830, 1.889090, 1.878470, 1.86968};
  double KfMA500MeV[nE0] =  {2.319160, 2.103600, 2.009160, 1.955630, 1.922030, 1.898750, 1.882260, 1.86934};
  double KfMA600MeV[nE0] =  {2.444460, 2.180240, 2.064440, 1.996480, 1.952570, 1.921850, 1.899060, 1.88231};
  double KfMA700MeV[nE0] =  {2.579300, 2.264840, 2.128200, 2.046330, 1.992200, 1.953890, 1.925300, 1.90397};
  double KfMA800MeV[nE0] =  {2.720680, 2.355410, 2.197810, 2.102550, 2.038350, 1.992400, 1.957980, 1.93185};
  double KfMA900MeV[nE0] =  {2.865950, 2.450690, 2.271800, 2.163460, 2.089440, 2.035840, 1.995810, 1.96446};
  double KfMA1000MeV[nE0] = {3.012420, 2.549700, 2.349220, 2.227970, 2.144360, 2.083180, 2.036740, 2.00084}; 
  double KfMA1100MeV[nE0] = {3.136760, 2.647460, 2.428160, 2.295070, 2.202820, 2.135170, 2.083400, 2.04300};
  double KfMA1200MeV[nE0] = {3.274900, 2.751080, 2.510380, 2.364570, 2.263030, 2.187930, 2.129750, 2.08337};
  double KfMA1300MeV[nE0] = {3.405690, 2.855720, 2.594580, 2.436110, 2.325390, 2.243070, 2.178850, 2.12867};
  double KfMA1400MeV[nE0] = {3.527070, 2.960480, 2.680120, 2.509050, 2.389420, 2.299960, 2.230120, 2.17456};
  double KfMA1500MeV[nE0] = {3.637620, 3.064150, 2.766550, 2.583330, 2.455110, 2.358360, 2.282870, 2.22396};
  double KfMA1600MeV[nE0] = {3.736660, 3.166150, 2.853450, 2.658580, 2.521680, 2.418290, 2.336990, 2.27166};
  double KfMA1700MeV[nE0] = {3.824160, 3.265030, 2.940170, 2.734590, 2.589330, 2.479140, 2.393090, 2.32238};
  double KfMA1800MeV[nE0] = {3.900650, 3.360040, 3.026300, 2.810730, 2.657690, 2.541120, 2.448860, 2.37419};
  double KfMA1900MeV[nE0] = {3.967000, 3.450390, 3.111260, 2.886900, 2.726620, 2.603830, 2.506310, 2.42697};
  double KfMA2000MeV[nE0] = {4.024310, 3.535460, 3.194460, 2.962980, 2.795580, 2.667070, 2.564460, 2.48071};
  double KfMA2100MeV[nE0] = {4.073750, 3.614820, 3.275310, 3.038220, 2.864650, 2.730660, 2.623120, 2.53575};
  double KfMA2200MeV[nE0] = {4.116470, 3.688210, 3.353540, 3.112320, 2.933460, 2.794410, 2.682380, 2.58984};
  double KfMA2300MeV[nE0] = {4.153550, 3.755560, 3.428580, 3.185150, 3.001720, 2.858130, 2.741800, 2.64537};
  double KfMA2400MeV[nE0] = {4.185950, 3.816950, 3.500090, 3.256200, 3.069390, 2.921740, 2.801370, 2.70156};
  double KfMA2500MeV[nE0] = {4.214540, 3.872580, 3.567800, 3.325210, 3.135860, 2.984970, 2.860830, 2.75699};
  double KfMA2600MeV[nE0] = {4.240040, 3.922750, 3.632510, 3.391880, 3.201140, 3.047280, 2.920120, 2.81309};
  double KfMA2700MeV[nE0] = {4.263080, 3.967810, 3.691220, 3.456020, 3.264920, 3.108840, 2.979040, 2.86932};
  double KfMA2800MeV[nE0] = {4.284210, 4.008190, 3.746850, 3.517350, 3.327040, 3.169490, 3.037390, 2.92494};
  double KfMA2900MeV[nE0] = {4.303870, 4.044280, 3.798320, 3.575820, 3.387200, 3.228940, 3.095160, 2.97807};
  double KfMA3000MeV[nE0] = {4.322450, 4.076500, 3.846040, 3.631220, 3.445300, 3.287030, 3.152050, 3.03544};
   
  // initialize K-factor matrix
  for (int j = 0; j < nE0; j++) {
    KKffactor[0][j] = KfMA1MeV[j];
    KKffactor[1][j] = KfMA2MeV[j];
    KKffactor[2][j] = KfMA4MeV[j];
    KKffactor[3][j] = KfMA6MeV[j];
    KKffactor[4][j] = KfMA8MeV[j];
    KKffactor[5][j] = KfMA10MeV[j];
    KKffactor[6][j] = KfMA20MeV[j];
    KKffactor[7][j] = KfMA30MeV[j];
    KKffactor[8][j] = KfMA40MeV[j];
    KKffactor[9][j] = KfMA50MeV[j];
    KKffactor[10][j] = KfMA60MeV[j];
    KKffactor[11][j] = KfMA70MeV[j];
    KKffactor[12][j] = KfMA80MeV[j];
    KKffactor[13][j] = KfMA90MeV[j];
    KKffactor[14][j] = KfMA100MeV[j];
    KKffactor[15][j] = KfMA200MeV[j];
    KKffactor[16][j] = KfMA300MeV[j];
    KKffactor[17][j] = KfMA400MeV[j];
    KKffactor[18][j] = KfMA500MeV[j];
    KKffactor[19][j] = KfMA600MeV[j];
    KKffactor[20][j] = KfMA700MeV[j];
    KKffactor[21][j] = KfMA800MeV[j];
    KKffactor[22][j] = KfMA900MeV[j];
    KKffactor[23][j] = KfMA1000MeV[j];   
    KKffactor[24][j] = KfMA1100MeV[j];
    KKffactor[25][j] = KfMA1200MeV[j];
    KKffactor[26][j] = KfMA1300MeV[j];
    KKffactor[27][j] = KfMA1400MeV[j];
    KKffactor[28][j] = KfMA1500MeV[j];
    KKffactor[29][j] = KfMA1600MeV[j];
    KKffactor[30][j] = KfMA1700MeV[j];
    KKffactor[31][j] = KfMA1800MeV[j];
    KKffactor[32][j] = KfMA1900MeV[j];
    KKffactor[33][j] = KfMA2000MeV[j];
    KKffactor[34][j] = KfMA2100MeV[j];
    KKffactor[35][j] = KfMA2200MeV[j];
    KKffactor[36][j] = KfMA2300MeV[j];
    KKffactor[37][j] = KfMA2400MeV[j];
    KKffactor[38][j] = KfMA2500MeV[j];
    KKffactor[39][j] = KfMA2600MeV[j];
    KKffactor[40][j] = KfMA2700MeV[j];
    KKffactor[41][j] = KfMA2800MeV[j];
    KKffactor[42][j] = KfMA2900MeV[j];
    KKffactor[43][j] = KfMA3000MeV[j];
  }

  // bounds for energy E0
  if (E0test <= EE00[0])
    E0test = 1.005 * EE00[0]; //  Lower limit for energy

  if (E0test >= EE00[nE0-1] )
    E0test  = 0.995 * EE00[nE0-1]; // Upper limit for energy

  // bounds for mass of Dark state MA
  if (MAtest <= MMAA[0])
    MAtest = 1.005 * MMAA[0]; //  Lower limit for mass

  if (MAtest >= MMAA[nMA-1] )
    MAtest  = 0.995 * MMAA[nMA-1]; // Upper limit for mass

  return BilinearInterpolation<nE0> (MAtest, E0test, MMAA, EE00, KKffactor, nMA, 1);
}
